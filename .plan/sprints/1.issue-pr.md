# Sprint 1 — Issue & PR plan

Issue: Sprint 1 — Database & Persistence

- Title: "Sprint 1 — Database & Persistence"
- Body / Description: Implement the Drizzle `contacts` table, repository
  functions, and unit tests so the backend has a stable persistence layer.
  Follow the tasks below and link the PR when ready.

Issue checklist (summary - manage work in the PR checklist below):

- Add Drizzle config wired to `DB_FILE_NAME` env
- Create `backend/db/schema/contacts.ts` (Drizzle table, snake_case columns)
- Implement `backend/db/repos/contacts.ts` functions (`createContact`,
  `listContacts`, `getContactById`, `verifyContact`, `deleteContact`)
- Add seed/migration script for local dev/tests
- Add unit tests for repository functions (Deno)
- Ensure types exported (Drizzle InferModel) and match Zod shared schema
- Update `.plan/specs/data-model.md` if DB shape tweaks are needed

---

PR: `sprint/1-db-persistence`

PR checklist (to include in PR description - single source of truth):

- [ ] Branch created from `main`: `sprint/1-db-persistence`
- [ ] Add Drizzle config wired to `DB_FILE_NAME` env
- [ ] Create `backend/db/schema/contacts.ts` (Drizzle table, snake_case columns)
- [ ] Implement `backend/db/repos/contacts.ts` functions:
  - [ ] `createContact`
  - [ ] `listContacts`
  - [ ] `getContactById`
  - [ ] `verifyContact`
  - [ ] `deleteContact`
- [ ] Add seed/migration script for local dev/tests
- [ ] Add unit tests for repository functions (Deno) and ensure they pass
      locally (`deno test`)
- [ ] Ensure types exported (Drizzle InferModel) and documented; map to Zod
      shared schema
- [ ] Update `.plan/specs/data-model.md` if DB shape tweaks were required
- [ ] README/docs updated with how to run tests and use the temp DB
- [ ] Link the issue in the PR description and request a reviewer

Notes:

- Keep PRs small and focused. If a task grows, split it into a follow-up PR.
- Use `DB_FILE_NAME` env override for local tests (temp sqlite file).

---

PR: `sprint/1-db-persistence`

PR checklist (to include in PR description):

- [ ] Branch created from `main`: `sprint/1-db-persistence`
- [ ] All repo functions implemented and exported
- [ ] Unit tests added and passing locally (`deno test`)
- [ ] Migration/seed script included for local dev
- [ ] Types exported and documented (Drizzle InferModel / Zod mapping)
- [ ] README/update docs: how to run tests and use the temp DB
- [ ] Mark the issue as linked in the PR description and request reviewer

Notes:

- Keep PRs small and focused. If a task grows, split it into a follow-up PR.
- Use `DB_FILE_NAME` env override for local tests (temp sqlite file).
