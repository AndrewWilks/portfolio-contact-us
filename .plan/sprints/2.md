# Sprint 2 — Backend endpoints (detailed)

Goal: implement the HTTP API that the frontend will consume. Use the repository
layer from Sprint 1 and Zod-first validation.

Tasks

- Routes

  - `POST /api/contacts` — validate `ContactCreate` and return `201, Contact`.
  - `GET /api/contacts` — support `q` search (first/last/email) and `verified` filter.
  - `PATCH /api/contacts/:id/verify` — mark verified, return updated Contact.
  - `DELETE /api/contacts/:id` — delete and return `204`.

- Validation & Middleware

  - Use `@hono/zod-validator` (or local wrapper) to validate request bodies.
  - Normalize validation errors into the project error envelope.

- Error handling

  - Non-2xx responses follow `{ ok: false, error: { code, message } }`.
  - Return `400` for validation, `404` for not-found, `500` for unexpected errors.

- Tests
  - Integration tests for each endpoint using the repo backed by a temp DB.
  - Simulate failure modes (invalid body, not-found id).

Acceptance criteria

- Endpoints are implemented and covered by integration tests.
- Handlers return the expected envelopes and status codes per `.plan/specs/api-contract.md`.
- Tests run on CI and locally with `deno test`.
